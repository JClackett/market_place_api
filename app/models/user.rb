class User < ActiveRecord::Base

# ------------------------------------------------------------------------------
# Includes & Extensions
# ------------------------------------------------------------------------------

# Include default devise modules. Others available are:
# :confirmable, :lockable, :timeoutable and :omniauthable
devise :database_authenticatable, :registerable, :recoverable, :rememberable, :trackable, :validatable

# ------------------------------------------------------------------------------
# Constants
# ------------------------------------------------------------------------------



# ------------------------------------------------------------------------------
# Attributes
# ------------------------------------------------------------------------------



# ------------------------------------------------------------------------------
# Associations
# ------------------------------------------------------------------------------

has_many :products, dependent: :destroy


# ------------------------------------------------------------------------------
# Validations
# ------------------------------------------------------------------------------

validates :auth_token, uniqueness: true
validates_uniqueness_of :email, case_sensitive: false

# ------------------------------------------------------------------------------
# Callbacks
# ------------------------------------------------------------------------------

before_create :generate_authentication_token!


# ------------------------------------------------------------------------------
# Nested Attributes
# ------------------------------------------------------------------------------



# ------------------------------------------------------------------------------
# Scopes
# ------------------------------------------------------------------------------



# ------------------------------------------------------------------------------
# Other
# ------------------------------------------------------------------------------



# ------------------------------------------------------------------------------
# Class Methods
# ------------------------------------------------------------------------------



# ------------------------------------------------------------------------------
# Instance Methods
# ------------------------------------------------------------------------------

def generate_authentication_token!
	begin
		self.auth_token = Devise.friendly_token
	end while self.class.exists?(auth_token: auth_token)
end


# ------------------------------------------------------------------------------
protected
# ------------------------------------------------------------------------------



# ------------------------------------------------------------------------------
private
# ------------------------------------------------------------------------------



end
